(()=>{"use strict";const e={};let t=!0,s=(e=500)=>{let s=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let e=0;e<n.length;e++){n[e].style.paddingRight="0px"}s.style.paddingRight="0px",document.documentElement.classList.remove("lock")}),e),t=!1,setTimeout((function(){t=!0}),e)}},n=(e=500)=>{let s=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");for(let e=0;e<n.length;e++){n[e].style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px"}s.style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px",document.documentElement.classList.add("lock"),t=!1,setTimeout((function(){t=!0}),e)}};e.popup=new class{constructor(e){let t={logging:!0,init:!0,attributeOpenButton:"data-popup",attributeCloseButton:"data-close",fixElementSelector:"[data-lp]",youtubeAttribute:"data-popup-youtube",youtubePlaceAttribute:"data-popup-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"popup__content",popupActive:"popup_show",bodyActive:"popup-show"},focusCatch:!0,closeEsc:!0,bodyLock:!0,hashSettings:{location:!1,goHash:!1},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.youTubeCode,this.isOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...t,...e,classes:{...t.classes,...e?.classes},hashSettings:{...t.hashSettings,...e?.hashSettings},on:{...t.on,...e?.on}},this.bodyLock=!1,this.options.init&&this.initPopups()}initPopups(){this.popupLogging("Проснулся"),this.eventsPopup()}eventsPopup(){document.addEventListener("click",function(e){const t=e.target.closest(`[${this.options.attributeOpenButton}]`);if(t)return e.preventDefault(),this._dataValue=t.getAttribute(this.options.attributeOpenButton)?t.getAttribute(this.options.attributeOpenButton):"error",this.youTubeCode=t.getAttribute(this.options.youtubeAttribute)?t.getAttribute(this.options.youtubeAttribute):null,"error"!==this._dataValue?(this.isOpen||(this.lastFocusEl=t),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,void this.open()):void this.popupLogging(`Ой ой, не заполнен атрибут у ${t.classList}`);return e.target.closest(`[${this.options.attributeCloseButton}]`)||!e.target.closest(`.${this.options.classes.popupContent}`)&&this.isOpen?(e.preventDefault(),void this.close()):void 0}.bind(this)),document.addEventListener("keydown",function(e){if(this.options.closeEsc&&27==e.which&&"Escape"===e.code&&this.isOpen)return e.preventDefault(),void this.close();this.options.focusCatch&&9==e.which&&this.isOpen&&this._focusCatch(e)}.bind(this)),this.options.hashSettings.goHash&&(window.addEventListener("hashchange",function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}.bind(this)),window.addEventListener("load",function(){window.location.hash&&this._openToHash()}.bind(this)))}open(e){if(t)if(this.bodyLock=!(!document.documentElement.classList.contains("lock")||this.isOpen),e&&"string"==typeof e&&""!==e.trim()&&(this.targetOpen.selector=e,this._selectorOpen=!0),this.isOpen&&(this._reopen=!0,this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(this.targetOpen.selector),this.targetOpen.element){if(this.youTubeCode){const e=`https://www.youtube.com/embed/${this.youTubeCode}?rel=0&showinfo=0&autoplay=1`,t=document.createElement("iframe");t.setAttribute("allowfullscreen","");const s=this.options.setAutoplayYoutube?"autoplay;":"";if(t.setAttribute("allow",`${s}; encrypted-media`),t.setAttribute("src",e),!this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)){this.targetOpen.element.querySelector(".popup__text").setAttribute(`${this.options.youtubePlaceAttribute}`,"")}this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(t)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),document.dispatchEvent(new CustomEvent("beforePopupOpen",{detail:{popup:this}})),this.targetOpen.element.classList.add(this.options.classes.popupActive),document.documentElement.classList.add(this.options.classes.bodyActive),this._reopen?this._reopen=!1:!this.bodyLock&&n(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout((()=>{this._focusTrap()}),50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}})),this.popupLogging("Открыл попап")}else this.popupLogging("Ой ой, такого попапа нет.Проверьте корректность ввода. ")}close(e){e&&"string"==typeof e&&""!==e.trim()&&(this.previousOpen.selector=e),this.isOpen&&t&&(this.options.on.beforeClose(this),document.dispatchEvent(new CustomEvent("beforePopupClose",{detail:{popup:this}})),this.youTubeCode&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&(this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""),this.previousOpen.element.classList.remove(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.documentElement.classList.remove(this.options.classes.bodyActive),!this.bodyLock&&s(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout((()=>{this._focusTrap()}),50),this.popupLogging("Закрыл попап"))}_getHash(){this.options.hashSettings.location&&(this.hash=this.targetOpen.selector.includes("#")?this.targetOpen.selector:this.targetOpen.selector.replace(".","#"))}_openToHash(){let e=document.querySelector(`.${window.location.hash.replace("#","")}`)?`.${window.location.hash.replace("#","")}`:document.querySelector(`${window.location.hash}`)?`${window.location.hash}`:null;(document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`)?document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`):document.querySelector(`[${this.options.attributeOpenButton} = "${e.replace(".","#")}"]`))&&e&&this.open(e)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(e){const t=this.targetOpen.element.querySelectorAll(this._focusEl),s=Array.prototype.slice.call(t),n=s.indexOf(document.activeElement);e.shiftKey&&0===n&&(s[s.length-1].focus(),e.preventDefault()),e.shiftKey||n!==s.length-1||(s[0].focus(),e.preventDefault())}_focusTrap(){const e=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():e[0].focus()}popupLogging(e){this.options.logging&&function(e){setTimeout((()=>{window.FLS&&console.log(e)}),0)}(`[Попапос]: ${e}`)}}({});let o=!1;setTimeout((()=>{if(o){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);class i{#e={};#t=0;#s=0;#n;#o;static itemTemplateId="progress-bar-item";static itemClassName="progress-bar__item";static itemCaptionClassName="progress-bar__item-caption";static itemStateClassName="progress-bar__item-state";static itemHiddenClassName="progress-bar__item_hidden";constructor(e,t){this.#n=e,this.#o=t;const s=document.querySelector(`.${e}`),n=document.getElementById(i.itemTemplateId).innerHTML;s.innerHTML=t.reduce(((e,t,s)=>{t.alias&&(this.#e[t.alias]=t);const o=t.subStepsCount>1?`0/${t.subStepsCount}`:"";return e+n.replace("{{idx}}",s).replace("{{caption}}",t.caption).replace("{{state}}",o)}),"");s.firstElementChild.classList.remove(i.itemHiddenClassName);s.lastElementChild.lastElementChild.remove()}next(){if(this.#t>=this.#o.length)return!1;const e=this.#o[this.#t],t=document.querySelector(`.${this.#n}`).querySelector(`[data-idx='${this.#t}']`);return this.#s<e.subStepsCount-1?(this.#s++,t.lastElementChild.textContent=`${this.#s}/${e.subStepsCount}`):(this.#s=0,this.#t++,t.classList.add("progress-bar__item_fulfilled"),this.#t<this.#o.length&&(t.lastElementChild.textContent=null,t.lastElementChild.classList.add("icon-success-arrow"),t.nextElementSibling.classList.remove(i.itemHiddenClassName))),!0}prev(){if(this.#t<=0)return!1;const e=document.querySelector(`.${this.#n}`);let t,s;this.#s>0?(this.#s--,t=e.querySelector(`[data-idx='${this.#t}']`),s=this.#o[this.#t],t.lastElementChild.textContent=`${this.#s}/${s.subStepsCount}`):(this.#t--,t=e.querySelector(`[data-idx='${this.#t}']`),s=this.#o[this.#t],t.lastElementChild.classList.remove("icon-success-arrow"),t.classList.remove("progress-bar__item_fulfilled"),s.subStepsCount>1&&(this.#s=s.subStepsCount-1,t.lastElementChild.textContent=`${this.#s}/${s.subStepsCount}`))}}function r(e){return"string"==typeof e&&e.length>0}let a;const c=[{alias:"power_bill",caption:"POWER BILL",subStepsCount:1},{alias:"address",caption:"ADDRESS",subStepsCount:1},{alias:"home_type",caption:"HOME TYPE",subStepsCount:2},{alias:"credit_score",caption:"CREDIT SCORE",subStepsCount:1},{alias:"contact",caption:"CONTACT",subStepsCount:3},{alias:"thank_you",caption:"THANK YOU",subStepsCount:1}],l=["avaragePowerBill","address","homeType","roofShade","creditScore","contact","email","phoneNumber","booking","thankYou"],u=e=>"string"==typeof e&&/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)?null:"Error: phone number is incorrect",d=e=>{if(!e||"string"!=typeof e)return"";const t=e.replace(/^\+1?/,"").match(/\d/gi);return t?t.reduce(((e,t)=>{switch(e.length){case 0:e.push("(");break;case 4:e.push(")"," ");break;case 9:e.push("-")}return e.push(t),e}),[]).join(""):""},p=e=>"string"==typeof e&&/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)?null:"Error: email is incorrect";class h{_onChangeListeners=[];_min;_max;_volume;_indicator;_value;_progress;_percentage;_thumbWidth;constructor(e,t,s,n){const o=document.querySelector(`.${e}`);this._min=o.getAttribute("min"),this._max=o.getAttribute("max"),this._volume=this._max-this._min,this._setValue(o.value),this._thumbWidth=t||40;const i=e=>{const t=e.offsetWidth,o=this._thumbWidth/t,i=o/2*100,r=i+this._percentage*(1-o);let a=`linear-gradient(90deg, ${s} ${i}%, ${s} ${r}%`;this._progress<this._volume&&(a+=`, ${void 0!==n?n:"rgba(255,255,255,0)"} ${r}%`),a+=")",e.style.backgroundImage=a};i(o),o.addEventListener("input",(e=>{e.preventDefault(),this._setValue(e.currentTarget.value),i(e.currentTarget),this._indicator&&this._updateIndicator(),this._onChangeListeners.forEach((e=>e(this._value,this._percentage)))})),window.addEventListener("resize",(t=>{const s=document.querySelector(`.${e}`);i(s)}))}_setValue(e){this._value=e,this._progress=this._value-this._min,this._percentage=this._progress/this._volume*100}_updateIndicator(){this._indicator.set(this._value,this._percentage)}getValue(){return this._value}addIndicator(e){this._indicator=e,this._updateIndicator()}subscribe(e){this._onChangeListeners.push(e)}unsubscribe(e){this._onChangeListeners=this._onChangeListeners.filter((t=>t!==e))}}class m{_rootId;_template;constructor(e,t){this._rootId=e,this._template=t}set(e,t){const s=document.querySelector(`#${this._rootId}`),n=(s.clientWidth,s.firstElementChild);n.textContent=this._template?this._template.replace("{{value}}",e):e;const o=n.offsetWidth;n.style.marginLeft=`calc(${t}% - ${o/2}px)`}}class g{static rootClassName=".base-form__address-field";_getRootNode=()=>document.querySelector(g.rootClassName);constructor(e){this._state=e;const t=this._getRootNode(),s=t.lastElementChild;s.addEventListener("blur",(e=>{this._onBlur(e)})),s.addEventListener("input",(e=>{this._onInput(e)})),e.store.isGoogleApiInit?this._initAutocomplete(t):e.onChange(((e,s)=>{e.isGoogleApiInit!==s.isGoogleApiInit&&e.isGoogleApiInit&&this._initAutocomplete(t)}))}_initAutocomplete(e){const t=(e||this._getRootNode()).lastElementChild,s=new google.maps.places.Autocomplete(t,{fields:["formatted_address","geometry","name"],strictBounds:!1,componentRestrictions:{country:"us"}});s.addListener("place_changed",(()=>{const e=s.getPlace();this._state.set((t=>({...t,address:e.formatted_address,isAddressAutocompleted:!0})))}))}_onInput(e){this._state.set((t=>({...t,address:e.currentTarget.value,isAddressAutocompleted:!1})))}_onBlur(e){this._state.set((t=>({...t,address:e.currentTarget.value,isAddressAutocompleted:!1})))}}class f{_formName;_name;constructor(e,t,s){this._formName=e,this._name=t;const n=document.querySelectorAll(`form[name='${e}'] input[name='${t}']`),o=e=>{s.set((s=>({...s,[t]:e.currentTarget.value})))};n&&n.forEach((e=>e.addEventListener("change",o)))}}class _{_formName;_name;_state;constructor(e,t,s,n,o){this._state=s,this._formName=e,this._name=t,this._validator=n,this._formatter=o,this._isValidFieldName=`is${t.replace(/^(.)/g,((e,t)=>t.toUpperCase()))}Valid`;const i=document.forms[this._formName][this._name];i.addEventListener("change",(e=>{s.set((s=>{const o=e.currentTarget.value;let i={...s,[t]:o};if(n)if(r(o)){const t=n(o);t?(e.currentTarget.parentElement.classList.add("error"),e.currentTarget.parentElement.classList.remove("valid"),i[this._isValidFieldName]=!1):(e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.add("valid"),i[this._isValidFieldName]=!0)}else e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.remove("valid"),i[this._isValidFieldName]=!1;return i}))})),i.addEventListener("input",(e=>{let i,a=e.currentTarget.value;i=n?!n(a):r(a),i?(e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.add("valid")):(e.currentTarget.parentElement.classList.remove("valid"),o&&(e.currentTarget.value=o(a))),s.set((s=>({...s,[this._isValidFieldName]:i,[t]:e.currentTarget.value})))}))}setErrorMsg(e){document.forms[this._formName][this._name].previousElementSibling.textContent=e}validate(){const e=document.forms[this._formName][this._name];if(e.required&&""===e.value)return e.parentElement.classList.add("error"),this.setErrorMsg("This field is required"),!1;if(this._validator&&r(e.value)){const t=this._validator(e.value);if(t)return e.parentElement.classList.add("error"),this.setErrorMsg(t),!1}return!0}reset(){const e=document.forms[this._formName][this._name];e.value=null,e.dispatchEvent(new Event("input")),e.dispatchEvent(new Event("change"))}}class b{_formName;_name;constructor(e,t,s){this._formName=e,this._name=t;const n=document.forms[this._formName][this._name],o=n.parentElement,i=e=>{s.set((s=>({...s,[t]:e.checked})))};i(n);n.addEventListener("change",(e=>{i(e.currentTarget)})),n.addEventListener("click",(e=>{e.stopPropagation()})),o.addEventListener("click",(e=>{e.preventDefault(),e.currentTarget.firstElementChild.checked=!e.currentTarget.firstElementChild.checked,e.currentTarget.firstElementChild.dispatchEvent(new Event("change"))}))}}class v{static rootClassName=".step-page-btn";static captionClassName=".step-page-btn__caption";_type;_selectNode(){return document.querySelector(`${v.rootClassName}[data-type="${this._type}"]`)}constructor(e){this._type=e}hide(){this._selectNode().classList.add("hidden")}show(){this._selectNode().classList.remove("hidden")}disable(){this._selectNode().disabled=!0}enable(){this._selectNode().disabled=!1}setCaption(e){this._selectNode().querySelector(v.captionClassName).textContent=e}}class S extends v{_state;constructor(e){super("next"),this._state=e,this._state.onChange(((e,t)=>{t.currentStep;const s=l[e.currentStep],{isGoogleApiInit:n,isAddressAutocompleted:o}=e;!function(t){switch(t){case"avaragePowerBill":return!0;case"address":const{address:t}=e;return"string"==typeof t&&t.length>3;case"homeType":const{homeType:s}=e;return void 0!==s;case"roofShade":const{roofShade:n}=e;return void 0!==n;case"creditScore":const{creditScore:o}=e;return void 0!==o;case"contact":const{firstName:i,lastName:a}=e;return r(i)&&r(a);case"email":const{isEmailValid:c}=e;return c;default:return!1}}(s)?this.disable():this.enable(),!function(e){switch(e){case"avaragePowerBill":case"address":case"homeType":case"roofShade":case"creditScore":case"contact":case"email":return!0;default:return!1}}(s)?this.hide():this.show()})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep+1})))}))}}class y extends v{_state;constructor(e){super("prev"),this._state=e;const t=e=>{const t=l[e.currentStep];"homeType"===t||"roofShade"===t||"address"===t||"creditScore"===t||"contact"===t||"email"===t||"phoneNumber"===t?this.show():this.hide()};t(this._state.store),this._state.onChange(((e,s)=>{t(e)})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep-1})))}))}}class C extends v{_state;constructor(e){super("submit"),this._state=e,this.hide(),this._state.onChange(((e,t)=>{e.isPhoneNumberValid?this.enable():this.disable();"phoneNumber"===l[e.currentStep]?this.show():this.hide()})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep+1})))}))}}class w{_state;constructor(e,t,s){this._state=e,this._state.onChange(((e,n,o)=>{if(e.processing&&(0===e.processingProgress||e.processingProgress!==n.processingProgress)){const n=document.querySelector(".processing-indicator__bar");let i=`linear-gradient(90deg, ${t} 0%, ${t} ${e.processingProgress}%`;i+=`, ${void 0!==s?s:"rgba(255,255,255,0)"} ${e.processingProgress}%`,i+=")",n.style.backgroundImage=i,e.processingProgress<80&&setTimeout((()=>{o((e=>({...e,processingProgress:e.processingProgress+Math.random()})))}),50)}}))}}class E{static rootClassName=".page";_state;_selectNode(){return document.querySelector(E.rootClassName)}constructor(e){this._state=e,this._selectNode().setAttribute("data-step",l[e.store.currentStep]),this._state.onChange(((e,t)=>{if(e.processing)this._selectNode().setAttribute("data-step",e.processing);else if(e.currentLocation)this._selectNode().setAttribute("data-step","article");else{const t=l[e.currentStep];this._selectNode().setAttribute("data-step",t)}}))}}function A(e){let t=[new _("refer","referFirstName",e),new _("refer","referLastName",e),new _("refer","referEmail",e,p),new _("refer","referPhone",e,u,d)];document.querySelector("#submit-refer-btn").addEventListener("click",(s=>{const n=t.reduce(((e,t)=>t.validate()&&e),!0),o=e.store;if(n){N({email:o.referEmail,phone:o.referPhone,firstName:o.referFirstName,lastName:o.referLastName,source:"public api",customField:{referred_by:`${o.firstName} ${o.lastName} ${o.phoneNumber}`}},"Refere",e)}}));let s,n=0;e.onChange(((e,o,i)=>{if(e.sendingRefere!==o.sendingRefere){const o=document.querySelector("#submit-refer-btn"),i=o.querySelector(".summary-block-btn__caption");if(o.disabled=e.sendingRefere,e.sendingRefere)s||(i.textContent="Sending",s=setInterval((()=>{i.textContent=i.textContent.replace(/\.*$/,".".repeat(n)),n<3?n++:n=0}),300));else{const n=document.querySelector("#referFormProcessingResult");n.classList.add("show"),e.sendingRefereResult&&e.sendingRefereResult.contact&&e.sendingRefereResult.contact.id?(n.textContent="Thank you for the referral! We will notify when we get in contact with them.",n.classList.remove("refer-form__processing-result_error"),t.forEach((e=>{e.reset()}))):(n.textContent=`Error: ${JSON.stringify(e.sendingRefereResult)}`,n.classList.add("refer-form__processing-result_error")),setTimeout((()=>{n.classList.remove("show")}),3e3),s&&(clearInterval(s),s=null),i.textContent="Submit another referral"}}}))}function L(e){document.querySelectorAll("a[data-link]").forEach((t=>{const s=t.getAttribute("data-link");e.onChange(((e,t,n)=>{const o=document.querySelector(`a[data-link="${s}"]`);e.currentLocation===s?o.classList.add("active"):o.classList.remove("active")})),t.addEventListener("click",(t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-link");document.querySelector(".page");"back"===s?e.set((e=>({...e,currentLocation:null}))):e.set((e=>({...e,currentLocation:s}))),function(e){const t={"privacy-policy":"privacy-policy-2","terms-and-conditions":"terms-and-conditions"},s=document.querySelector(".article__body");s.firstElementChild&&s.removeChild(s.firstElementChild);s.innerHTML=`<iframe id="article" scrolling="no" style="width: 100%; border:none; overflow: hidden;" src="https://calculatemysolarsavings.com/${t[e]}/"></iframe>`}(s)}))}))}function N(e,t,s){const n=e=>{s.set?s.set(e):s(e)};return n((e=>({...e,[`sending${t}`]:!0}))),JSON.stringify(e),fetch("https://calculatemysolarsavings.com/wp-json/ghl-hooks/v1/contacts/",{method:"POST",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify({postId:a,contact:e})}).then((e=>e.json())).then((e=>{n((s=>({...s,[`sending${t}Result`]:e,[`sending${t}`]:!1})))})).catch((e=>{n((s=>({...s,[`sending${t}Result`]:e,[`sending${t}`]:!1})))}))}const T=new class{_store;_prevStore={};_subscriptions=[];constructor(e={}){this._store=e}set(e){this._prevStore=this._store,this._store=e(this._store),this._subscriptions.forEach((e=>e(this._store,this._prevStore,(e=>{this.set(e)})))),JSON.stringify(this._store),JSON.stringify(this._prevStore)}get store(){return this._store}onChange(e){this._subscriptions.push(e)}}({isGoogleApiInit:!1,currentStep:0});window.initGoogleApi=()=>{T.set((e=>({...e,isGoogleApiInit:!0})))},window.addEventListener("DOMContentLoaded",(function(e){!function(){a=parseInt(document.querySelector("#post_id").textContent);new E(T);T.onChange(((t,s,n)=>{const{currentStep:o}=t,i=s.currentStep,a=l[o];if(t.address===s.address&&t.avarageBill===s.avarageBill||t.rebatesAreChecked&&n((e=>({...e,rebatesAreChecked:!1}))),t.processingProgress!==s.processingProgress&&t.processingProgress>80&&"homeType"===a&&n((e=>({...e,processing:null,processingProgress:0}))),o!==i)if(o<i?e.prev():e.next(),"homeType"!==a||t.rebatesAreChecked){if("booking"===a){document.querySelector("#send-form-btn").dispatchEvent(new Event("click"));const e=document.querySelector(".booking-step__title"),s=e.textContent;e.textContent=s.replace("{{firstName}}",t.firstName),n((e=>({...e,processing:"processingForm",processingProgress:0})));N({email:t.email,phone:`+1${t.phoneNumber.match(/\d/g).join("")}`,firstName:t.firstName,lastName:t.lastName,name:`${t.firstName} ${t.lastName}`,address:t.address,tags:["online","english"],source:"public api",customField:{average_electric_bill:t.avarageBill,home_type:t.homeType,roof_shade:t.roofShade,credit_score:t.creditScore,is_property_owner:t.isOwner,email_me_my_report:t.emailMe}},"Customer",n)}}else n((e=>({...e,rebatesAreChecked:!0,processing:"checkingRebates",processingProgress:0})));if(t.calendarIsReady!==s.calendarIsReady&&t.calendarIsReady&&n((e=>({...e,processing:!1}))),t.sendingCustomer===s.sendingCustomer||t.sendingCustomer||t.sendingCustomerResult.contact.id&&n((e=>({...e,processing:!1}))),t.formIsAvailable&&t.formIsAvailable!=s.formIsAvailable){n((e=>({...e,processing:"processingBooking",processingProgress:0})));document.querySelector("#schedule-appointment").dispatchEvent(new Event("click")),c="setFieldsAndSend",u={firstName:(d=t).firstName,lastName:d.lastName,email:d.email,phoneNumber:`+1${d.phoneNumber}`},document.querySelector(".booking-step iframe").contentWindow.postMessage({action:c,payload:u},"*")}var c,u,d;if(t.ghlFormIsSent&&t.ghlFormIsSent!==s.ghlFormIsSent){const e=document.querySelector(".summary__title"),s=e.textContent;e.textContent=s.replace("{{firstName}}",t.firstName),b("google"),b("outlook"),v(),n((e=>({...e,currentStep:e.currentStep+1,processing:null,processingProgress:0})))}const{roofShade:p,creditScore:h,homeType:m}=t,g=s.roofShade,f=s.creditScore,_=s.homeType;function b(e){document.querySelector(`#add-to-${e}-calendar`).setAttribute("href",t.addToCalendarLinks[e])}function v(){let e=document.querySelector("#appointment-call-duration");const s=t.appointmentInfo.duration.match(/^\d+/g);s&&(e.textContent=e.textContent.replace("{{duration}}",s[0])),e=document.querySelector("#appointment-call-date-time"),e.textContent=t.appointmentInfo.dateTime,e=document.querySelector("#appointment-call-timezone"),e.textContent=t.appointmentInfo.timezone}(p!==g&&r(p)&&"roofShade"===a||h!==f&&r(h)&&"creditScore"===a||m!==_&&r(m)&&"homeType"===a)&&n((e=>({...e,currentStep:e.currentStep+1})))}));const e=new i("guide__progress-bar",c);(function(){if(location.hash.toLowerCase().includes("show-service-btns")){document.querySelector("#service-btns-for-pixel").style.display="flex"}})(),function(){function e(e){var t=e.querySelectorAll(".accordion__item"),s=e.querySelector(".accordion__item.accordion__item_opened");function n(e){e.addEventListener("click",o)}function o(e){e.currentTarget.classList.contains("accordion__item_opened")?(e.currentTarget.classList.remove("accordion__item_opened"),s=null):(e.currentTarget.classList.add("accordion__item_opened"),s&&s.classList.remove("accordion__item_opened"),s=e.currentTarget)}t.forEach(n)}document.querySelectorAll(".accordion").forEach(e)}(),L(T),A(T);new S(T),new y(T),new C(T);const t=new h("range__input",40,"#00ABA1"),s=new m("power-bill-indicator","${{value}}");t.addIndicator(s),t.subscribe((e=>{T.set((t=>({...t,avarageBill:e})))})),T.set((e=>({...e,avarageBill:t.getValue()})));new g(T),new f("quiz","homeType",T),new f("quiz","roofShade",T),new f("quiz","creditScore",T),new _("quiz","firstName",T),new _("quiz","lastName",T),new b("quiz","isOwner",T),new _("quiz","email",T,p),new b("quiz","emailMe",T),new _("quiz","phoneNumber",T,u,d),new w(T,"#00ABA1");document.querySelectorAll("input").forEach((e=>{("radio"!==e.getAttribute("type")||e.checked)&&e.dispatchEvent(new Event("change"))}))}()})),window.addEventListener("message",(function(e){if(e.data instanceof Array){if(e.data[0],e.data[2],"set-sticky-contacts"===e.data[0]){const t=JSON.parse(e.data[2]).appointment.id;T.set((e=>({...e,appointmentId:t})))}}else switch(e.data.action,e.data.action){case"calendarIsReady":T.set((e=>({...e,calendarIsReady:!0})));break;case"formIsAvailable":T.set((e=>({...e,formIsAvailable:!0})));break;case"dataTimeIsPicked":T.set((e=>({...e,dataTimeIsPicked:!0})));break;case"formIsSent":T.set((t=>({...t,ghlFormIsSent:!0,addToCalendarLinks:e.data.payload.calendarLinks,appointmentInfo:e.data.payload.appointmentInfo})));break;case"error":T.set((t=>({...t,ghlFormError:e.data.payload})));break;case"iframeHeightReport":t=e.data.payload.height,window.frames.article.style.height=`${t}px`}var t})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}))})();