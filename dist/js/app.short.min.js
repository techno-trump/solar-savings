(()=>{"use strict";const e={};let t=!0,s=(e=500)=>{let s=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let e=0;e<n.length;e++){n[e].style.paddingRight="0px"}s.style.paddingRight="0px",document.documentElement.classList.remove("lock")}),e),t=!1,setTimeout((function(){t=!0}),e)}},n=(e=500)=>{let s=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");for(let e=0;e<n.length;e++){n[e].style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px"}s.style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px",document.documentElement.classList.add("lock"),t=!1,setTimeout((function(){t=!0}),e)}};e.popup=new class{constructor(e){let t={logging:!0,init:!0,attributeOpenButton:"data-popup",attributeCloseButton:"data-close",fixElementSelector:"[data-lp]",youtubeAttribute:"data-popup-youtube",youtubePlaceAttribute:"data-popup-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"popup__content",popupActive:"popup_show",bodyActive:"popup-show"},focusCatch:!0,closeEsc:!0,bodyLock:!0,hashSettings:{location:!1,goHash:!1},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.youTubeCode,this.isOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...t,...e,classes:{...t.classes,...e?.classes},hashSettings:{...t.hashSettings,...e?.hashSettings},on:{...t.on,...e?.on}},this.bodyLock=!1,this.options.init&&this.initPopups()}initPopups(){this.popupLogging("Проснулся"),this.eventsPopup()}eventsPopup(){document.addEventListener("click",function(e){const t=e.target.closest(`[${this.options.attributeOpenButton}]`);if(t)return e.preventDefault(),this._dataValue=t.getAttribute(this.options.attributeOpenButton)?t.getAttribute(this.options.attributeOpenButton):"error",this.youTubeCode=t.getAttribute(this.options.youtubeAttribute)?t.getAttribute(this.options.youtubeAttribute):null,"error"!==this._dataValue?(this.isOpen||(this.lastFocusEl=t),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,void this.open()):void this.popupLogging(`Ой ой, не заполнен атрибут у ${t.classList}`);return e.target.closest(`[${this.options.attributeCloseButton}]`)||!e.target.closest(`.${this.options.classes.popupContent}`)&&this.isOpen?(e.preventDefault(),void this.close()):void 0}.bind(this)),document.addEventListener("keydown",function(e){if(this.options.closeEsc&&27==e.which&&"Escape"===e.code&&this.isOpen)return e.preventDefault(),void this.close();this.options.focusCatch&&9==e.which&&this.isOpen&&this._focusCatch(e)}.bind(this)),this.options.hashSettings.goHash&&(window.addEventListener("hashchange",function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}.bind(this)),window.addEventListener("load",function(){window.location.hash&&this._openToHash()}.bind(this)))}open(e){if(t)if(this.bodyLock=!(!document.documentElement.classList.contains("lock")||this.isOpen),e&&"string"==typeof e&&""!==e.trim()&&(this.targetOpen.selector=e,this._selectorOpen=!0),this.isOpen&&(this._reopen=!0,this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(this.targetOpen.selector),this.targetOpen.element){if(this.youTubeCode){const e=`https://www.youtube.com/embed/${this.youTubeCode}?rel=0&showinfo=0&autoplay=1`,t=document.createElement("iframe");t.setAttribute("allowfullscreen","");const s=this.options.setAutoplayYoutube?"autoplay;":"";if(t.setAttribute("allow",`${s}; encrypted-media`),t.setAttribute("src",e),!this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)){this.targetOpen.element.querySelector(".popup__text").setAttribute(`${this.options.youtubePlaceAttribute}`,"")}this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(t)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),document.dispatchEvent(new CustomEvent("beforePopupOpen",{detail:{popup:this}})),this.targetOpen.element.classList.add(this.options.classes.popupActive),document.documentElement.classList.add(this.options.classes.bodyActive),this._reopen?this._reopen=!1:!this.bodyLock&&n(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout((()=>{this._focusTrap()}),50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}})),this.popupLogging("Открыл попап")}else this.popupLogging("Ой ой, такого попапа нет.Проверьте корректность ввода. ")}close(e){e&&"string"==typeof e&&""!==e.trim()&&(this.previousOpen.selector=e),this.isOpen&&t&&(this.options.on.beforeClose(this),document.dispatchEvent(new CustomEvent("beforePopupClose",{detail:{popup:this}})),this.youTubeCode&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&(this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""),this.previousOpen.element.classList.remove(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.documentElement.classList.remove(this.options.classes.bodyActive),!this.bodyLock&&s(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout((()=>{this._focusTrap()}),50),this.popupLogging("Закрыл попап"))}_getHash(){this.options.hashSettings.location&&(this.hash=this.targetOpen.selector.includes("#")?this.targetOpen.selector:this.targetOpen.selector.replace(".","#"))}_openToHash(){let e=document.querySelector(`.${window.location.hash.replace("#","")}`)?`.${window.location.hash.replace("#","")}`:document.querySelector(`${window.location.hash}`)?`${window.location.hash}`:null;(document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`)?document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`):document.querySelector(`[${this.options.attributeOpenButton} = "${e.replace(".","#")}"]`))&&e&&this.open(e)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(e){const t=this.targetOpen.element.querySelectorAll(this._focusEl),s=Array.prototype.slice.call(t),n=s.indexOf(document.activeElement);e.shiftKey&&0===n&&(s[s.length-1].focus(),e.preventDefault()),e.shiftKey||n!==s.length-1||(s[0].focus(),e.preventDefault())}_focusTrap(){const e=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():e[0].focus()}popupLogging(e){this.options.logging&&function(e){setTimeout((()=>{window.FLS&&console.log(e)}),0)}(`[Попапос]: ${e}`)}}({});let r=!1;setTimeout((()=>{if(r){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);class o{#e={};#t=0;#s=0;#n;#r;static itemTemplateId="progress-bar-item";static itemClassName="progress-bar__item";static itemCaptionClassName="progress-bar__item-caption";static itemStateClassName="progress-bar__item-state";static itemHiddenClassName="progress-bar__item_hidden";constructor(e,t){this.#n=e,this.#r=t;const s=document.querySelector(`.${e}`),n=document.getElementById(o.itemTemplateId).innerHTML;s.innerHTML=t.reduce(((e,t,s)=>{t.alias&&(this.#e[t.alias]=t);const r=t.subStepsCount>1?`0/${t.subStepsCount}`:"";return e+n.replace("{{idx}}",s).replace("{{caption}}",t.caption).replace("{{state}}",r)}),"");s.firstElementChild.classList.remove(o.itemHiddenClassName);s.lastElementChild.lastElementChild.remove()}next(){if(this.#t>=this.#r.length)return!1;const e=this.#r[this.#t],t=document.querySelector(`.${this.#n}`).querySelector(`[data-idx='${this.#t}']`);return this.#s<e.subStepsCount-1?(this.#s++,t.lastElementChild.textContent=`${this.#s}/${e.subStepsCount}`):(this.#s=0,this.#t++,t.classList.add("progress-bar__item_fulfilled"),this.#t<this.#r.length&&(t.lastElementChild.textContent=null,t.lastElementChild.classList.add("icon-success-arrow"),t.nextElementSibling.classList.remove(o.itemHiddenClassName))),!0}prev(){if(this.#t<=0)return!1;const e=document.querySelector(`.${this.#n}`);let t,s;this.#s>0?(this.#s--,t=e.querySelector(`[data-idx='${this.#t}']`),s=this.#r[this.#t],t.lastElementChild.textContent=`${this.#s}/${s.subStepsCount}`):(this.#t--,t=e.querySelector(`[data-idx='${this.#t}']`),s=this.#r[this.#t],t.lastElementChild.classList.remove("icon-success-arrow"),t.classList.remove("progress-bar__item_fulfilled"),s.subStepsCount>1&&(this.#s=s.subStepsCount-1,t.lastElementChild.textContent=`${this.#s}/${s.subStepsCount}`))}}function i(e){return"string"==typeof e&&e.length>0}let a,c;const l=[{alias:"power_bill",caption:"POWER BILL",subStepsCount:1},{alias:"address",caption:"ADDRESS",subStepsCount:1},{alias:"credit_score",caption:"CREDIT SCORE",subStepsCount:1},{alias:"name",caption:"NAME",subStepsCount:1},{alias:"contact",caption:"CONTACT",subStepsCount:2},{alias:"thank_you",caption:"THANK YOU",subStepsCount:1}],u=["avaragePowerBill","address","creditScore","contact","email","phoneNumber","booking","thankYou"],d=e=>"string"==typeof e&&/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)?null:"Error: phone number is incorrect",p=e=>{if(!e||"string"!=typeof e)return"";const t=e.replace(/^\+1?/,"").match(/\d/gi);return t?t.reduce(((e,t)=>{switch(e.length){case 0:e.push("(");break;case 4:e.push(")"," ");break;case 9:e.push("-")}return e.push(t),e}),[]).join(""):""},h=e=>"string"==typeof e&&/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)?null:"Error: email is incorrect";class m{_onChangeListeners=[];_min;_max;_volume;_indicator;_value;_progress;_percentage;_thumbWidth;constructor(e,t,s,n){const r=document.querySelector(e);this._min=r.getAttribute("min"),this._max=r.getAttribute("max"),this._volume=this._max-this._min,this._setValue(r.value),this._thumbWidth=t||40;const o=e=>{const t=e.offsetWidth,r=this._thumbWidth/t,o=r/2*100,i=o+this._percentage*(1-r);let a=`linear-gradient(90deg, ${s} ${o}%, ${s} ${i}%`;this._progress<this._volume&&(a+=`, ${void 0!==n?n:"rgba(255,255,255,0)"} ${i}%`),a+=")",e.style.backgroundImage=a};o(r),r.addEventListener("input",(e=>{e.preventDefault(),this._setValue(e.currentTarget.value),o(e.currentTarget),this._indicator&&this._updateIndicator(),this._onChangeListeners.forEach((e=>e(this._value,this._percentage)))})),window.addEventListener("resize",(t=>{const s=document.querySelector(e);o(s)})),new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.target instanceof HTMLElement&&e.target.id===r.id&&o(e.target)}))}),{rootMargin:"0px",threshold:0}).observe(r)}_setValue(e){this._value=e,this._progress=this._value-this._min,this._percentage=this._progress/this._volume*100}_updateIndicator(){this._indicator.set(this._value,this._percentage)}getValue(){return this._value}addIndicator(e){this._indicator=e,this._updateIndicator()}subscribe(e){this._onChangeListeners.push(e)}unsubscribe(e){this._onChangeListeners=this._onChangeListeners.filter((t=>t!==e))}}class g{_selector;_template;constructor(e,t){this._selector=e,this._template=t}set(e,t){const s=document.querySelector(this._selector),n=(s.clientWidth,s.firstElementChild);this._template?"function"==typeof this._template?n.textContent=this._template(e):n.textContent=this._template.replace("{{value}}",e):n.textContent=e;const r=n.offsetWidth;n.style.marginLeft=`calc(${t}% - ${r/2}px)`}}class f{static rootClassName=".base-form__address-field";_getRootNode=()=>document.querySelector(f.rootClassName);constructor(e){this._state=e;const t=this._getRootNode(),s=t.lastElementChild;s.addEventListener("blur",(e=>{this._onBlur(e)})),s.addEventListener("input",(e=>{this._onInput(e)})),e.store.isGoogleApiInit?this._initAutocomplete(t):e.onChange(((e,s)=>{e.isGoogleApiInit!==s.isGoogleApiInit&&e.isGoogleApiInit&&this._initAutocomplete(t)}))}_initAutocomplete(e){const t=(e||this._getRootNode()).lastElementChild,s=new google.maps.places.Autocomplete(t,{fields:["formatted_address","geometry","name"],strictBounds:!1,componentRestrictions:{country:"us"}});s.addListener("place_changed",(()=>{const e=s.getPlace();this._state.set((t=>({...t,address:e.formatted_address,isAddressAutocompleted:!0})))}))}_onInput(e){this._state.set((t=>({...t,address:e.currentTarget.value,isAddressAutocompleted:!1})))}_onBlur(e){this._state.set((t=>({...t,address:e.currentTarget.value,isAddressAutocompleted:!1})))}}class _{_formName;_name;constructor(e,t,s){this._formName=e,this._name=t;const n=document.querySelectorAll(`form[name='${e}'] input[name='${t}']`),r=e=>{s.set((s=>({...s,[t]:e.currentTarget.value})))};n&&n.forEach((e=>e.addEventListener("change",r)))}}class b{_formName;_name;_state;constructor(e,t,s,n,r){this._state=s,this._formName=e,this._name=t,this._validator=n,this._formatter=r,this._isValidFieldName=`is${t.replace(/^(.)/g,((e,t)=>t.toUpperCase()))}Valid`;const o=document.forms[this._formName][this._name];o.addEventListener("change",(e=>{s.set((s=>{const r=e.currentTarget.value;let o={...s,[t]:r};if(n)if(i(r)){const t=n(r);t?(e.currentTarget.parentElement.classList.add("error"),e.currentTarget.parentElement.classList.remove("valid"),o[this._isValidFieldName]=!1):(e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.add("valid"),o[this._isValidFieldName]=!0)}else e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.remove("valid"),o[this._isValidFieldName]=!1;return o}))})),o.addEventListener("input",(e=>{let o,a=e.currentTarget.value;o=n?!n(a):i(a),o?(e.currentTarget.parentElement.classList.remove("error"),e.currentTarget.parentElement.classList.add("valid")):(e.currentTarget.parentElement.classList.remove("valid"),r&&(e.currentTarget.value=r(a))),s.set((s=>({...s,[this._isValidFieldName]:o,[t]:e.currentTarget.value})))}))}setErrorMsg(e){document.forms[this._formName][this._name].previousElementSibling.textContent=e}validate(){const e=document.forms[this._formName][this._name];if(e.required&&""===e.value)return e.parentElement.classList.add("error"),this.setErrorMsg("This field is required"),!1;if(this._validator&&i(e.value)){const t=this._validator(e.value);if(t)return e.parentElement.classList.add("error"),this.setErrorMsg(t),!1}return!0}reset(){const e=document.forms[this._formName][this._name];e.value=null,e.dispatchEvent(new Event("input")),e.dispatchEvent(new Event("change"))}}class v{_formName;_name;constructor(e,t,s){this._formName=e,this._name=t;const n=document.forms[this._formName][this._name],r=n.parentElement,o=e=>{s.set((s=>({...s,[t]:e.checked})))};o(n);n.addEventListener("change",(e=>{o(e.currentTarget)})),n.addEventListener("click",(e=>{e.stopPropagation()})),r.addEventListener("click",(e=>{e.preventDefault(),e.currentTarget.firstElementChild.checked=!e.currentTarget.firstElementChild.checked,e.currentTarget.firstElementChild.dispatchEvent(new Event("change"))}))}}class y{static rootClassName=".step-page-btn";static captionClassName=".step-page-btn__caption";_type;_selectNode(){return document.querySelector(`${y.rootClassName}[data-type="${this._type}"]`)}constructor(e){this._type=e}hide(){this._selectNode().classList.add("hidden")}show(){this._selectNode().classList.remove("hidden")}disable(){this._selectNode().disabled=!0}enable(){this._selectNode().disabled=!1}setCaption(e){this._selectNode().querySelector(y.captionClassName).textContent=e}}class S extends y{_state;constructor(e){super("next"),this._state=e,this._state.onChange(((e,t)=>{u[t.currentStep];const s=u[e.currentStep],{isGoogleApiInit:n,isAddressAutocompleted:r}=e;!function(t){switch(t){case"avaragePowerBill":return!0;case"address":const{address:t}=e;return"string"==typeof t&&t.length>3;case"homeType":const{homeType:s}=e;return void 0!==s;case"roofShade":const{roofShade:n}=e;return void 0!==n;case"creditScore":const{creditScore:r}=e;return void 0!==r;case"contact":const{firstName:o,lastName:a}=e;return i(o)&&i(a);case"email":const{isEmailValid:c}=e;return c;default:return!1}}(s)?this.disable():this.enable(),!function(e){switch(e){case"avaragePowerBill":case"address":case"homeType":case"roofShade":case"creditScore":case"contact":case"email":return!0;default:return!1}}(s)?this.hide():this.show()})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep+1})))}))}}class C extends y{_state;constructor(e){super("prev"),this._state=e;const t=e=>{const t=u[e.currentStep];"homeType"===t||"roofShade"===t||"address"===t||"creditScore"===t||"contact"===t||"email"===t||"phoneNumber"===t?this.show():this.hide()};t(this._state.store),this._state.onChange(((e,s)=>{t(e)})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep-1})))}))}}class w extends y{_state;constructor(e){super("submit"),this._state=e,this.hide(),this._state.onChange(((e,t)=>{e.isPhoneNumberValid?this.enable():this.disable();"phoneNumber"===u[e.currentStep]?this.show():this.hide()})),this._selectNode().addEventListener("click",(e=>{e.preventDefault(),this._state.set((e=>({...e,currentStep:e.currentStep+1})))}))}}class E{_state;constructor(e,t,s){this._state=e,this._state.onChange(((e,n,r)=>{if(e.processing&&(0===e.processingProgress||e.processingProgress!==n.processingProgress)){const n=document.querySelector(".processing-indicator__bar");let o=`linear-gradient(90deg, ${t} 0%, ${t} ${e.processingProgress}%`;o+=`, ${void 0!==s?s:"rgba(255,255,255,0)"} ${e.processingProgress}%`,o+=")",n.style.backgroundImage=o,e.processingProgress<80&&setTimeout((()=>{r((e=>({...e,processingProgress:e.processingProgress+Math.random()})))}),50)}}))}}class A{static rootClassName=".page";_state;_selectNode(){return document.querySelector(A.rootClassName)}constructor(e){this._state=e,this._selectNode().setAttribute("data-step",u[e.store.currentStep]),this._state.onChange(((e,t)=>{if(e.processing)this._selectNode().setAttribute("data-step",e.processing);else if(e.currentLocation)this._selectNode().setAttribute("data-step","article");else{const t=u[e.currentStep];"thankYou"===t&&e.badSummary?this._selectNode().setAttribute("data-step","badSummary"):this._selectNode().setAttribute("data-step",t)}}))}}function L(e){let t=[new b("refer","referFirstName",e),new b("refer","referLastName",e),new b("refer","referEmail",e,h),new b("refer","referPhone",e,d,p)];document.querySelector("#submit-refer-btn").addEventListener("click",(s=>{const n=t.reduce(((e,t)=>t.validate()&&e),!0),r=e.store;if(n){T({email:r.referEmail,phone:r.referPhone,firstName:r.referFirstName,lastName:r.referLastName,source:"public api",customField:{referred_by:`${r.firstName} ${r.lastName} ${r.phoneNumber}`}},"Refere",e)}}));let s,n=0;e.onChange(((e,r,o)=>{if(e.sendingRefere!==r.sendingRefere){const r=document.querySelector("#submit-refer-btn"),o=r.querySelector(".summary-block-btn__caption");if(r.disabled=e.sendingRefere,e.sendingRefere)s||(o.textContent="Sending",s=setInterval((()=>{o.textContent=o.textContent.replace(/\.*$/,".".repeat(n)),n<3?n++:n=0}),300));else{const n=document.querySelector("#referFormProcessingResult");n.classList.add("show"),e.sendingRefereResult&&e.sendingRefereResult.contact&&e.sendingRefereResult.contact.id?(n.textContent="Thank you for the referral! We will notify when we get in contact with them.",n.classList.remove("refer-form__processing-result_error"),t.forEach((e=>{e.reset()}))):(n.textContent=`Error: ${JSON.stringify(e.sendingRefereResult)}`,n.classList.add("refer-form__processing-result_error")),setTimeout((()=>{n.classList.remove("show")}),3e3),s&&(clearInterval(s),s=null),o.textContent="Submit another referral"}}}))}function N(e){document.querySelectorAll("a[data-link]").forEach((t=>{const s=t.getAttribute("data-link");e.onChange(((e,t,n)=>{const r=document.querySelector(`a[data-link="${s}"]`);e.currentLocation===s?r.classList.add("active"):r.classList.remove("active")})),t.addEventListener("click",(t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-link");document.querySelector(".page");"back"===s?e.set((e=>({...e,currentLocation:null}))):e.set((e=>({...e,currentLocation:s}))),function(e){const t={"privacy-policy":"?page_id=5758","terms-and-conditions":"?page_id=5760"},s=document.querySelector(".article__body");s.firstElementChild&&s.removeChild(s.firstElementChild);s.innerHTML=`<iframe id="article" scrolling="no" style="width: 100%; border:none; overflow: hidden;" src="https://calculatemysolarsavings.com/${t[e]}/"></iframe>`}(s)}))}))}function T(e,t,s){const n=e=>{s.set?s.set(e):s(e)};return n((e=>({...e,[`sending${t}`]:!0}))),JSON.stringify(e),fetch(`${c}ghl-hooks/v1/contacts/`,{method:"POST",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify({postId:a,contact:e})}).then((e=>e.json())).then((e=>{n((s=>({...s,[`sending${t}Result`]:e,[`sending${t}`]:!1})))})).catch((e=>{n((s=>({...s,[`sending${t}Result`]:e,[`sending${t}`]:!1})))}))}const O=new class{_store;_prevStore={};_subscriptions=[];constructor(e={}){this._store=e}set(e){this._prevStore=this._store,this._store=e(this._store),this._subscriptions.forEach((e=>e(this._store,this._prevStore,(e=>{this.set(e)})))),JSON.stringify(this._store),JSON.stringify(this._prevStore)}get store(){return this._store}onChange(e){this._subscriptions.push(e)}}({isGoogleApiInit:!1,currentStep:0});window.initGoogleApi=()=>{O.set((e=>({...e,isGoogleApiInit:!0})))},window.addEventListener("DOMContentLoaded",(function(e){!function(){const e=document.querySelector("[rel='https://api.w.org/']");c=e?e.href:"https://calculatemysolarsavings.com/index.php?rest_route=/";a=parseInt(document.querySelector("#post_id").textContent);new A(O);O.onChange(((e,s,n)=>{const{currentStep:r}=e,o=s.currentStep,a=u[r];if(e.address===s.address&&e.avarageBill===s.avarageBill||e.rebatesAreChecked&&n((e=>({...e,rebatesAreChecked:!1}))),e.processingProgress!==s.processingProgress&&e.processingProgress>80&&"homeType"===a&&n((e=>({...e,processing:null,processingProgress:0}))),r!==o)if(r<o?t.prev():t.next(),"homeType"!==a||e.rebatesAreChecked){if("booking"===a){if(document.querySelector("#send-form-btn").dispatchEvent(new Event("click")),e.isOwner&&"below600"!==e.creditScore){const t=document.querySelector(".booking-step__title"),s=t.textContent;t.textContent=s.replace("{{firstName}}",e.firstName),n((e=>({...e,processing:"processingForm",processingProgress:0})));T(y(e),"Customer",n)}else{const t=document.querySelector("#bad-summary-title"),s=t.textContent;t.textContent=s.replace("{{firstName}}",e.firstName),n((e=>({...e,processing:"processingForm",processingProgress:0,currentStep:u.indexOf("thankYou"),badSummary:!0})));T(y(e,["disqualified"]),"Customer",n)}}}else n((e=>({...e,rebatesAreChecked:!0,processing:"checkingRebates",processingProgress:0})));if(e.calendarIsReady!==s.calendarIsReady&&e.calendarIsReady&&n((e=>({...e,processing:!1}))),e.sendingCustomer===s.sendingCustomer||e.sendingCustomer||e.sendingCustomerResult.contact.id&&n((e=>({...e,processing:!1}))),e.formIsAvailable&&e.formIsAvailable!=s.formIsAvailable){n((e=>({...e,processing:"processingBooking",processingProgress:0})));document.querySelector("#schedule-appointment").dispatchEvent(new Event("click")),c="setFieldsAndSend",l={firstName:(d=e).firstName,lastName:d.lastName,email:d.email,phoneNumber:`+1${d.phoneNumber}`},document.querySelector(".booking-step iframe").contentWindow.postMessage({action:c,payload:l},"*")}var c,l,d;if(e.ghlFormIsSent&&e.ghlFormIsSent!==s.ghlFormIsSent){const t=document.querySelector(".summary__title"),s=t.textContent;t.textContent=s.replace("{{firstName}}",e.firstName),b("google"),b("outlook"),v(),n((e=>({...e,currentStep:e.currentStep+1,processing:null,processingProgress:0})))}const{roofShade:p,creditScore:h,homeType:m}=e,g=s.roofShade,f=s.creditScore,_=s.homeType;function b(t){document.querySelector(`#add-to-${t}-calendar`).setAttribute("href",e.addToCalendarLinks[t])}function v(){let t=document.querySelector("#appointment-call-duration");const s=e.appointmentInfo.duration.match(/^\d+/g);s&&(t.textContent=t.textContent.replace("{{duration}}",s[0])),t=document.querySelector("#appointment-call-date-time"),t.textContent=e.appointmentInfo.dateTime,t=document.querySelector("#appointment-call-timezone"),t.textContent=e.appointmentInfo.timezone}function y(e,t){const s=["online","english"];return{email:e.email,phone:`+1${e.phoneNumber.match(/\d/g).join("")}`,firstName:e.firstName,lastName:e.lastName,name:`${e.firstName} ${e.lastName}`,address:e.address,tags:t instanceof Array?s.concat(t):s,source:"public api",customField:{average_electric_bill:e.avarageBill,credit_score:e.creditScore,is_property_owner:e.isOwner,email_me_my_report:e.emailMe}}}(p!==g&&i(p)&&"roofShade"===a||h!==f&&i(h)&&"creditScore"===a||m!==_&&i(m)&&"homeType"===a)&&n((e=>({...e,currentStep:e.currentStep+1})))}));const t=new o("guide__progress-bar",l);(function(){if(location.hash.toLowerCase().includes("show-service-btns")){document.querySelector("#service-btns-for-pixel").style.display="flex"}})(),function(){function e(e){var t=e.querySelectorAll(".accordion__item"),s=e.querySelector(".accordion__item.accordion__item_opened");function n(e){e.addEventListener("click",r)}function r(e){e.currentTarget.classList.contains("accordion__item_opened")?(e.currentTarget.classList.remove("accordion__item_opened"),s=null):(e.currentTarget.classList.add("accordion__item_opened"),s&&s.classList.remove("accordion__item_opened"),s=e.currentTarget)}t.forEach(n)}document.querySelectorAll(".accordion").forEach(e)}(),N(O),L(O);new S(O),new C(O),new w(O);const s=new m("#avarage-bill-input",40,"#00ABA1"),n=new g("#power-bill-indicator","${{value}}");s.addIndicator(n),s.subscribe((e=>{O.set((t=>({...t,avarageBill:e})))})),O.set((e=>({...e,avarageBill:s.getValue()})));const r=new m("#years-to-calculate-input",40,"#00ABA1"),y=new g("#years-to-calculate-indicator",(e=>1==e?"1 year":`${e} years`));(function(e){const t=document.querySelector(".savings-calculator__text"),s=t.innerHTML,n=e=>String(e).split(/\B(?=(?:\d{3})+$)/g).join(","),r=(e,r)=>{const o=Math.floor(function(e,t){const s=12*e,n=function(e,t){const s=1.035;return e*((Math.pow(s,t+1)-1)/(s-1)-1)}(s,t);return n-.75*s*t}(r,e)),i=2*o,a=1==e?"year":"years",c=s.replace("{{avaragePowerBill}}",n(r)).replace("{{yearsNumber}}",e).replace("{{yearsLabel}}",a).replace("{{savings25}}",n(o)).replace("{{savings50}}",n(i));t.innerHTML=c};e.onChange(((e,t)=>{e.avarageBill===t.avarageBill&&e.yearsToCalculate===t.yearsToCalculate||r(Number(e.yearsToCalculate),Number(e.avarageBill))}))})(O),r.addIndicator(y),r.subscribe((e=>{O.set((t=>({...t,yearsToCalculate:e})))})),O.set((e=>({...e,avarageBill:s.getValue()}))),O.set((e=>({...e,yearsToCalculate:r.getValue()})));new f(O),new _("quiz","homeType",O),new _("quiz","roofShade",O),new _("quiz","creditScore",O),new b("quiz","firstName",O),new b("quiz","lastName",O),new v("quiz","isOwner",O),new b("quiz","email",O,h),new v("quiz","emailMe",O),new b("quiz","phoneNumber",O,d,p),new E(O,"#00ABA1");document.querySelectorAll("input").forEach((e=>{("radio"!==e.getAttribute("type")||e.checked)&&e.dispatchEvent(new Event("change"))}))}()})),window.addEventListener("message",(function(e){if(e.data instanceof Array){if(e.data[0],e.data[2],"set-sticky-contacts"===e.data[0]){const t=JSON.parse(e.data[2]).appointment.id;O.set((e=>({...e,appointmentId:t})))}}else switch(e.data.action,e.data.action){case"calendarIsReady":O.set((e=>({...e,calendarIsReady:!0})));break;case"formIsAvailable":O.set((e=>({...e,formIsAvailable:!0})));break;case"dataTimeIsPicked":O.set((e=>({...e,dataTimeIsPicked:!0})));break;case"formIsSent":O.set((t=>({...t,ghlFormIsSent:!0,addToCalendarLinks:e.data.payload.calendarLinks,appointmentInfo:e.data.payload.appointmentInfo})));break;case"error":O.set((t=>({...t,ghlFormError:e.data.payload})));break;case"iframeHeightReport":t=e.data.payload.height,window.frames.article.style.height=`${t}px`}var t})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}))})();